
|![](Aspose.Words.8ac9c90d-2492-4930-9d3d-4fa56a8a2919.001.jpeg)|<p>**Министерство науки и высшего образования Российской Федерации**</p><p>**Федеральное государственное автономного образовательное учреждение** </p><p>**высшего образования**</p><p>**«Московский государственный технический университет**</p><p>**имени Н.Э. Баумана**</p><p>**(национальный исследовательский университет)»**</p><p>**(МГТУ им. Н.Э. Баумана)**</p>|
| :- | :-: |


|ФАКУЛЬТЕТ|Космический|
| :- | :- |
|КАФЕДРА|К3|


**КУРСОВАЯ РАБОТА**

`                              `***ПО ДИСЦИПЛИНЕ:***

|***Проектирование распределённых баз данных***|
| :-: |
||
||
||

***НА ТЕМУ:***

|***Проектирование базы данных сайта*** |
| :-: |
|***онлайн-магазина***|
||
||



|Студент|`       `К3-33М||||`    `Бодров А.Р.|
| :- | :- | :- | :- | :- | :- |
||(группа)||(подпись, дата)||(И.О. Фамилия)|
|Руководитель курсового проекта|||||<p></p><p>Брюквина О.Ю.</p>|
||||(подпись, дата)||(И.О. Фамилия)|
|||||||
|Консультант|||||Брюквина О.Ю.|
||||(подпись, дата)||(И.О. Фамилия)|



`  `*2024 г*


**Министерство науки и высшего образования Российской Федерации**

**Федеральное государственное бюджетное образовательное учреждение** 

**высшего образования**

**«Московский государственный технический университет имени Н.Э. Баумана**

**(национальный исследовательский университет)»**

**(МГТУ им. Н.Э. Баумана)**

|УТВЕРЖДАЮ||||
| :-: | :- | :- | :- |
|||||
|`  `Заведующий кафедрой||||
||(индекс)|||
|||||
||(И.О. Фамилия)|||
|(подпись)||||
||(дата)|||

` `**ЗАДАНИЕ**

**на выполнение курсовой работы**

|По дисциплине:|Проектирование распределённых бах данных|||||
| :- | :- | :- | :- | :- | :- |
|Студент группы:|К3-33М, Бодров Артем Романович|||||
||(Фамилия, имя, отчество)|||||
|Тема курсовой работы:  ||||||
|||||||
|Проектирование базы данных сайта онлайн-магазина||||||
|Направленность КР:||||||
|||||||
|Учебная||||||
|Источник тематики (кафедра, предприятие, НИР):   кафедра                       ||||||
|<p></p><p>Задание:</p>|Выполнить проектирование базы данных на языке MongoDB. Описать предметную область, оргганизовать выборку из БД, разработать технологии к БД|||||
|||||||
|||||||
|||||||
|||||||
|||||||
|||||||
|Оформление курсовой работы:||||||
|||||||
|Расчетно-пояснительная записка (Отчет по КР) на \_33\_\_ листах формата А4.||||||
|||||||
|||||||
|||||||
|||||||

Дата выдачи задания « \_\_\_ » \_\_\_\_\_\_\_\_\_\_\_\_ 20\_\_ г.

|**Руководитель курсовой работы**         ||||`   `Брюквина О.Ю.|
| :- | :- | :- | :- | :- |
|||(подпись, дата)||(И.О. Фамилия)|
|**Студент**||||`   `Бодров А.Р.|
|||(подпись, дата)||(И.О. Фамилия)|

Примечание: Задание оформляется в двух экземплярах: один выдается студенту, второй хранится на кафедре.

**Министерство науки и высшего образования Российской Федерации**

**Федеральное государственное бюджетное образовательное учреждение** 

**высшего образования**

**«Московский государственный технический университет имени Н.Э. Баумана**

**(национальный исследовательский университет)»**

**(МГТУ им. Н.Э. Баумана)**


**КАЛЕНДАРНЫЙ ПЛАН**

**на выполнение курсовой работы**

|По дисциплине:|Базы данных||
| :- | :- | :- |
|Студент группы:|К3-33М, Бодров Артем Романович||
||(Фамилия, имя, отчество)||
|Тема курсовой работы:|Проектирование базы данных Steam||
||||
||||

|**№ п/п**|**Наименование этапов выпускной квалификационной работы**|**Сроки выполнения этапов**|**Отметка о выполнении**|||
| :-: | :-: | :-: | :-: | :- | :- |
|||**план**|**факт**|**Руководитель КР**|**Куратор**|
|1\.|Задание на выполнение курсовой работы|<p>*\_\_\_\_\_\_\_\_\_\_\_\_*</p><p>*Планируемая дата*</p>|||<p></p><p></p>|
|2\.|1 модуль|<p>*\_\_\_\_\_\_\_\_\_\_\_\_*</p><p>*Планируемая дата*</p>|||<p></p><p></p>|
|3\.|2 модуль|<p>*\_\_\_\_\_\_\_\_\_\_\_\_*</p><p>*Планируемая дата*</p>|||<p></p><p></p>|
|4\.|3 модуль|<p>*\_\_\_\_\_\_\_\_\_\_\_\_*</p><p>*Планируемая дата*</p>|||<p></p><p></p>|
|5\.|4 модуль|<p>*\_\_\_\_\_\_\_\_\_\_\_\_*</p><p>*Планируемая дата*</p>||||
|6\.|Оформление РПЗ (Отчета)|<p>*\_\_\_\_\_\_\_\_\_\_\_\_*</p><p>*Планируемая дата* </p>||||
|7\.|Подготовка доклада и презентации (при необходимости)|<p>*\_\_\_\_\_\_\_\_\_\_\_\_*</p><p>*Планируемая дата*</p>||||
|8\.|Защита курсовой работы|<p>*\_\_\_\_\_\_\_\_\_\_\_\_*</p><p>*Планируемая дата*</p>||||

Студент *\_\_\_\_\_\_\_\_\_\_\_*\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_	 Руководитель работы *\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_*

`	`<sup>(подпись, дата)</sup>						




` `**Содержание**

[Введение](#_toc432417725)

[1. Определение предметной области](#_toc432417726)

[2. Объекты таблицы](#_toc432417727)

[3. Создание таблиц](#_toc432417728)

[4. Запросы](#_toc432417730)

[5. Технологии](#_toc432417730) доступа к БД

[Заключение](#_toc432417731)

[Список использованных источников](#_toc432417732)






































<a name="_toc390618555"></a><a name="_toc432417725"></a>**Введение**

Современные информационные системы оперируют всё большими объёмами данных, что приводит к необходимости применения гибких и масштабируемых механизмов их хранения. Традиционные реляционные системы управления базами данных (СУБД), такие как PostgreSQL, остаются надёжным инструментом для работы со структурированными данными, однако рост требований к производительности, горизонтальному масштабированию и динамическому изменению структуры данных стимулирует переход к нереляционным решениям. Одним из наиболее распространённых представителей класса NoSQL-баз данных является MongoDB, использующая документно-ориентированную модель хранения.

В рамках данной работы рассматривается процесс переноса проекта базы данных, изначально реализованного в реляционной модели PostgreSQL, в среду MongoDB с использованием гибридного подхода. Гибридная модель сочетает преимущества денормализации — как средства ускорения чтения и уменьшения количества связей, — и ссылочной модели, позволяющей обеспечить структурированность, целостность и удобство аналитической обработки данных.

Предметом исследования является база данных онлайн-платформы цифровой дистрибуции игр, аналогичной по принципам работы сервису Steam. Такая платформа использует широкий набор сущностей: пользователей, игровые продукты, жанры, разработчиков, отзывы, транзакции, социальные связи и списки желаемого. Переход к документно-ориентированному хранению данных позволяет оптимизировать процессы взаимодействия пользователей с системой, ускорить выборки и обеспечить адаптивность структуры данных при расширении функциональности.

Целью работы является анализ исходной реляционной модели, разработка гибридной NoSQL-архитектуры, описание её структурных компонентов, реализация коллекций MongoDB, формирование основных и аналитических запросов, а также определение технологий доступа к базе данных. Кроме того, в исследование включены методы обеспечения целостности и согласованности данных при отсутствии встроенных механизмов триггеров, характерных для реляционных СУБД.

Результатом работы является документированная структура базы данных, ориентированная на применение в современных высоконагруженных веб-приложениях, а также обоснование выбора NoSQL-подхода для задач подобного класса.



<a name="_toc390618556"></a><a name="_toc432417726"></a>			**1. Определение предметной области**


`	`Предметная область разрабатываемой базы данных охватывает функциональность онлайн-платформы цифровой дистрибуции игр, аналогичной по структуре и принципам работы сервису Steam. Основная задача такой системы — обеспечение взаимодействия пользователей с цифровыми игровыми продуктами, что включает покупку, оценку, хранение, социальное взаимодействие и управление личной игровой библиотекой. Для корректной работы платформы требуется хранение и обработка значительного объёма разнородных данных, включая персональную информацию пользователей, характеристики игровых объектов, отзывы, транзакции и элементы социальной активности.

`	`Центральным элементом предметной области являются пользователи, каждый из которых имеет уникальный профиль и набор связанных данных: список приобретённых игр, оставленные отзывы, взаимодействие с другими пользователями, а также перечень игр, добавленных в список желаемого. Эти данные используются как для персонализации рекомендаций, так и для обеспечения корректной работы сервисов платформы.

`	`Второй ключевой сущностью являются игры, характеризуемые набором описательных атрибутов: названием, разработчиком, жанром, датой выпуска, метаданными и пользовательским рейтингом. Игровые продукты находятся в центре всех взаимодействий, поскольку именно они составляют основной контент платформы.

`	`Немаловажную роль играют разработчики и жанры, формирующие иерархическую классификацию контента и обеспечивающие удобную навигацию для пользователей. Связи между играми, жанрами и разработчиками позволяют формировать расширенные выборки, фильтрацию и рекомендации.

`	`Важным компонентом являются отзывы пользователей, которые позволяют формировать средние рейтинги игр, поддерживать механизмы обратной связи и влияют на видимость игр в каталоге. Отзывы содержат как текстовые комментарии, так и числовые оценки.

`	`Дополнительное значение имеют транзакции, фиксирующие процесс покупки игр пользователями, и социальные связи, такие как дружба между пользователями. Эти элементы позволяют расширить функциональность платформы, обеспечивая взаимодействие между пользователями и формируя более глубокую модель поведения внутри системы.

`	`Таким образом, предметная область охватывает комплекс взаимосвязанных сущностей, участие которых в платформе цифровой дистрибуции требует надёжной, гибкой и масштабируемой системы хранения данных. В условиях высокой нагрузки и постоянного расширения функциональности применение NoSQL-подхода с гибридной организацией коллекций позволяет оптимизировать хранение данных и повысить эффективность работы системы.

В качестве критериев выбора предлагаются следующие объекты:

1\.Users (Пользователи)

2\.Games (Игры)

3\. Genres (Жанры)

4\. Developers (Разработчики)

5\. Reviews (Отзывы)

6\. Friendships (Дружбы между пользователями)

7\. Wishlist (Список желаемого)

8\. Transactions (Транзакции)




# <a name="_toc432417727"></a>**2. Объекты таблицы**
Описание сущностей и атрибутов базы данных

**Users (Пользователи)**

Коллекция *Users* содержит информацию о пользователях платформы. Каждый пользователь имеет уникальный идентификатор и набор атрибутов, необходимых для работы системы.

**Атрибуты:**

- **\_id (ObjectId)** — уникальный идентификатор пользователя.
- **username (String, NOT NULL, уникальный)** — имя пользователя.
- **email (String, NOT NULL, уникальный)** — электронная почта пользователя.
- **password\_hash (String, NOT NULL)** — хеш пароля пользователя.
- **registration\_date (Date)** — дата и время регистрации.
- **profile (Document)** — дополнительная информация о пользователе:
  - display\_name (String)
  - country (String)
- **wishlist (Array)** — список желаемых игр:
  - game\_id (ObjectId)
  - added\_date (Date)
- **friends (Array)** — список друзей пользователя:
  - user\_id (ObjectId)
  - since (Date)

Коллекция Users формирует основу социальной части платформы и используется всеми связанными сущностями.

**Games (Игры)**

Коллекция *Games* содержит метаданные об играх, доступных на платформе. Данные используются в каталоге и в механизмах рекомендаций.

**Атрибуты:**

- **\_id (ObjectId)** — уникальный идентификатор игры.
- **title (String, NOT NULL)** — название игры.
- **release\_date (Date)** — дата выхода.
- **developer (Document)** — сведения о разработчике:
  - id (ObjectId)
  - name (String)
- **genre (Document)** — сведения о жанре:
  - id (ObjectId)
  - name (String)
- **price (Number)** — стоимость игры.
- **average\_rating (Number)** — средний рейтинг игры, рассчитываемый на основе отзывов.
- **reviews\_sample (Array)** — небольшая выборка последних отзывов:
  - user\_id (ObjectId)
  - rating (Number)
  - comment (String)
  - date (Date)
- **metadata (Document)** — техническая информация:
  - platforms (Array)
  - tags (Array)

Игры являются центральной сущностью, с которой связаны отзывы, транзакции, списки желаемого и пользовательская активность.

**Genres (Жанры)**

Коллекция *Genres* содержит информацию о жанровой классификации игр.

**Атрибуты:**

- **\_id (ObjectId)** — уникальный идентификатор жанра.
- **name (String, NOT NULL, уникальный)** — название жанра.

Жанры используются для классификации игр и формирования тематических выборок.

**Developers (Разработчики)**

Коллекция *Developers* включает информацию о разработчиках игр — как отдельных студиях, так и крупных компаниях.

**Атрибуты:**

- **\_id (ObjectId)** — уникальный идентификатор разработчика.
- **name (String, NOT NULL, уникальный)** — название компании-разработчика.
- **website (String)** — официальный сайт разработчика.
- **country (String)** — страна происхождения.

Разработчики связаны с играми и позволяют формировать аналитические запросы по студиям.

**Reviews (Отзывы)**

Коллекция *Reviews* содержит отзывы пользователей о конкретных играх. Отдельное хранение отзывов позволяет эффективно масштабировать базу данных.

**Атрибуты:**

- **\_id (ObjectId)** — уникальный идентификатор отзыва.
- **game\_id (ObjectId)** — идентификатор игры, на которую оставлен отзыв.
- **user\_id (ObjectId)** — идентификатор пользователя автора отзыва.
- **rating (Number, CHECK 1–5)** — оценка игры.
- **comment (String)** — текст комментария.
- **review\_date (Date)** — дата публикации отзыва.

Отзывы выполняют ключевую роль в формировании пользовательских рейтингов и рекомендаций.

**Transactions (Транзакции)**

Коллекция *Transactions* фиксирует покупки игр пользователями. Эти данные используются для финансовой аналитики и управления библиотекой игр.

**Атрибуты:**

- **\_id (ObjectId)** — уникальный идентификатор транзакции.
- **user\_id (ObjectId)** — идентификатор пользователя, совершившего покупку.
- **game\_id (ObjectId)** — идентификатор приобретённой игры.
- **price (Number)** — стоимость приобретённой игры на момент покупки.
- **purchase\_date (Date)** — дата совершения покупки.
- **payment\_method (String)** — способ оплаты.

**Wishlist (Список желаемого)** 

Используется в том случае, если объём списков у пользователей слишком велик для хранения в массиве.

**Атрибуты:**

- **\_id (ObjectId)** — уникальный идентификатор записи.
- **user\_id (ObjectId)** — идентификатор пользователя.
- **game\_id (ObjectId)** — идентификатор игры.
- **added\_date (Date)** — дата добавления в список.

**Friendships (Дружба)** 

Дополнительная коллекция, применяемая при больших объёмах социальных связей между пользователями.

**Атрибуты:**

- **\_id (ObjectId)** — уникальный идентификатор.
- **user1\_id (ObjectId)** — первый пользователь.
- **user2\_id (ObjectId)** — второй пользователь.
- **friendship\_date (Date)** — дата установления дружбы.


База данных содержит следующие связи между таблицами:

**Связь Users — Reviews**

**Тип связи:** *один ко многим (1:N)*

Один пользователь может оставить множество отзывов. В коллекции *Reviews* хранится поле user\_id, содержащее ссылку на документ из коллекции *Users*. Данная связь обеспечивает возможность получения всех отзывов конкретного пользователя.

**Связь Users — Transactions**

**Тип связи:** *один ко многим (1:N)*

Каждый пользователь может совершить множество покупок. В коллекции *Transactions* присутствует поле user\_id, представляющее собой ссылку на пользователя. На основе этой связи формируется история покупок.

**Связь Users — Wishlist**

**Тип связи:** *один ко многим (1:N)* или *вложенная структура*

В базовой гибридной модели данные списка желаемого хранятся внутри документа *Users* в виде массива.\
При больших объёмах данных используется отдельная коллекция *Wishlist*, где каждая запись содержит user\_id. В обоих случаях сохраняется связь пользователя с множеством элементов списка желаемого.

**Связь Users — Friendships**

**Тип связи:** *многие ко многим (M:N)*

Социальная связь «дружба» моделируется как отдельная коллекция *Friendships*, где каждая запись содержит пару пользователей (user1\_id, user2\_id).\
Такой подход позволяет эффективно масштабировать социальный граф.

**Связь Games — Reviews**

**Тип связи:** *один ко многим (1:N)*

Каждая игра может иметь множество отзывов. В коллекции *Reviews* хранится поле game\_id, указывающее на игру.\
Кроме того, в коллекции *Games* хранится небольшая выборка отзывов (reviews\_sample), что ускоряет отображение данных без выполнения тяжёлых запросов.

**Связь Games — Transactions**

**Тип связи:** *один ко многим (1:N)*

Каждая покупка связана с конкретной игрой. Коллекция *Transactions* содержит поле game\_id, отображающее игру, которая была приобретена пользователем.

**Связь Games — Developers**

**Тип связи:** *многие к одному (N:1)*

Несколько игр могут принадлежать одному разработчику.\
В коллекции *Games* сведения о разработчике представлены в виде вложенного документа с денормализованными полями developer.id и developer.name.\
При необходимости детальной информации используется обращение к коллекции *Developers*.

**Связь Games — Genres**

**Тип связи:** *многие к одному (N:1)*

Каждая игра относится к определённому жанру. В коллекции *Games* хранится вложенный документ genre, содержащий ссылку и название жанра.\
Дополнительная аналитика доступна через коллекцию *Genres*.

**Связь Users — Users (Дружба)**

**Тип связи:** *многие ко многим (M:N)*

Связь реализуется либо:

- внутри документа пользователя (массив друзей friends), либо
- в отдельной коллекции (*Friendships*) для больших графов связей.


Список ограничений для каждой таблицы в базе данных Steam:

**Коллекция Users (Пользователи)**

**Ограничения:**

1. Поле **\_id**:
   1. тип *ObjectId*, генерируется автоматически.
1. Поля **username** и **email**:
   1. обязательные (required: true),
   1. строковые значения,
   1. должны быть **уникальными**,
   1. длина не менее 3 символов.
1. Поле **password\_hash**:
   1. обязательное,
   1. строка фиксированного формата (bcrypt/argon2),
   1. запрещено хранить открытые пароли.
1. Поле **registration\_date**:
   1. автоматически заполняется,
   1. тип *Date*,
   1. не может быть больше текущей даты.
1. Поле **profile**:
   1. вложенный документ фиксированной структуры;
   1. display\_name — строка длиной не более 50 символов;
   1. country — строка из двух символов (ISO-код).
1. Поле **wishlist**:
   1. массив документов фиксированного формата;
   1. каждый элемент содержит game\_id: ObjectId;
   1. даты добавления должны быть валидного формата *Date*.
1. Поле **friends**:
   1. массив ссылок вида user\_id: ObjectId;
   1. запрещено наличие ссылки на самого себя;
   1. отсутствие дубликатов.

**Коллекция Games (Игры)**

**Ограничения:**

1. Поле **title**:
   1. тип *String*,
   1. обязательное,
   1. длина от 1 до 200 символов.
1. Поля **developer.id**, **genre.id**:
   1. обязательные,
   1. тип *ObjectId*.
1. Поля **developer.name** и **genre.name**:
   1. строковые,
   1. длина до 100 символов.
1. Поле **price**:
   1. тип *Number*,
   1. значение ≥ 0,
   1. запрещены отрицательные цены.
1. Поле **average\_rating**:
   1. число от 1 до 5 (или null до появления отзывов).
1. Поле **reviews\_sample**:
   1. массив документов фиксированного формата;
   1. количество элементов ограничено (например, max = 10);
   1. rating только в диапазоне 1–5;
   1. comment — строка длиной ≤ 500 символов.
1. Поле **metadata**:
   1. обязательная структура: platforms (array), tags (array);
   1. размер массива платформ ≤ 10;
   1. допустимые значения платформ определяются whitelist (например, PC, PS5).
1. Запрещается удалять игру, если существуют связанные транзакции или отзывы (ограничение уровня приложения).

**Коллекция Genres (Жанры)**

**Ограничения:**

1. Поле **name**:
   1. строка, обязательное поле,
   1. уникальное значение,
   1. длина 1–50 символов.
1. Удаление жанра возможно только при отсутствии связанных игр (реализуется приложением).

**Коллекция Developers (Разработчики)**

**Ограничения:**

1. Поле **name**:
   1. обязательное,
   1. уникальное,
   1. строка длиной до 100 символов.
1. Поле **website**:
   1. строка;
   1. значение должно соответствовать формату URL.
1. Поле **country**:
   1. строка длиной до 50 символов.
1. Удаление разработчика запрещено, если существуют связанные игры.

**Коллекция Reviews (Отзывы)**

**Ограничения:**

1. Поля **game\_id** и **user\_id**:
   1. обязательные,
   1. тип *ObjectId*.
1. Поле **rating**:
   1. обязательное;
   1. число от 1 до 5;
   1. проверка CHECK (в MongoDB — через JSON Schema).
1. Поле **comment**:
   1. строка длиной ≤ 2000 символов.
1. Поле **review\_date**:
   1. обязательное,
   1. не может быть будущей датой.
1. Один пользователь может оставить только **один отзыв на одну игру** (ограничение через составной индекс: { user\_id: 1, game\_id: 1 }, unique).

**Коллекция Transactions (Транзакции)**

**Ограничения:**

1. Поле **user\_id**, **game\_id** — обязательные ссылки типа *ObjectId*.
1. Поле **price**:
   1. число ≥ 0,
   1. не допускается отрицательное значение.
1. Поле **purchase\_date**:
   1. обязательное,
   1. не может быть будущей датой.
1. Поле **payment\_method**:
   1. строка,
   1. значение должно входить в заданный перечень:\
      (["card", "wallet", "gift\_code"]).
1. Запрещается удалять пользователя или игру, если существуют связанные транзакции.

**Коллекция Wishlist (при вынесении из Users)**

**Ограничения:**

1. Поле user\_id и game\_id — обязательные ссылки.
1. Дубликаты пары *(user\_id, game\_id)* запрещены\
   (уникальный составной индекс: { user\_id:1, game\_id:1 }).
1. Поле added\_date — валидная дата.

` `**Коллекция Friendships (при вынесении из Users)**

**Ограничения:**

1. Поля user1\_id и user2\_id — обязательные ObjectId.
1. Пользователь не может быть другом сам себе (user1 ≠ user2).
1. Пара друзей должна быть уникальной (уникальный составной индекс).
1. Запрещены дублирующие пары в обратном порядке (friendship A–B = B–A).
1. Поле friendship\_date — валидная дата.

**Общие ограничения базы данных**

1. BSON-документ не может превышать 16 МБ (все коллекции).
1. Все ObjectId должны соответствовать стандартному формату 24-hex.
1. Все даты — ISODate, UTC.
1. Все массивы ограничены по размеру (wishlist, reviews\_sample и др.).
1. Поля, не определённые в JSON Schema, запрещены (strict mode).
1. Целостность связей обеспечивается:
   1. транзакциями,
   1. ограничениями индексов,
   1. проверками уровня приложения.

\
`	`Выше представлены ограничения, определённые для каждой коллекции в рамках проектируемой NoSQL базы данных. Ограничения включают требования к типам данных, обязательности полей, уникальности, диапазонам значений, структурам вложенных документов и логическим ограничениям между сущностями.

`	`Процесс нормализации является важным этапом проектирования баз данных, направленным на устранение избыточности, предотвращение аномалий вставки, обновления и удаления, а также обеспечение логической целостности хранимых данных. В классических реляционных СУБД нормализация производится путём приведения отношений к нормальным формам (1NF, 2NF, 3NF, BCNF). Однако в документно-ориентированных базах данных, таких как MongoDB, нормализация не всегда применяется в чистом виде.

`	`Тем не менее, логическая структура проектируемых коллекций Steam изначально была сформирована на основе нормализованной реляционной модели, что обеспечивает корректность взаимосвязей и отсутствие противоречивых данных. На этапе переноса в MongoDB выполнена частичная денормализация, обусловленная требованиями производительности и особенностями работы NoSQL-хранилищ.

Ниже рассматриваются этапы нормализации и обоснование их применения.

**Нормализация отношений**

**Первая нормальная форма (1NF)**

Согласно первой нормальной форме, все данные должны быть атомарными, таблицы не должны содержать повторяющихся групп и вложенных множеств.

При проектировании реляционной модели Steam:

- Все сущности содержали атомарные атрибуты.
- Повторяющиеся группы (например, списки игр, отзывы, друзья) были вынесены в отдельные отношения.
- Каждая таблица имела чётко определённый первичный ключ.

Соответствие 1NF выполнено полностью.

В MongoDB вложенные массивы допустимы, однако используются только там, где это оправдано (wishlist, friends, reviews\_sample) и не нарушает логическую целостность.

**Вторая нормальная форма (2NF)**

Вторая нормальная форма требует отсутствия частичных зависимостей от составного первичного ключа.\
Для таблиц PostgreSQL:

- В таблицах с составными ключами (например, Wishlist, Friendships) каждый неключевой атрибут зависел от всей пары ключей.
- Дублирующие данные были вынесены в отдельные сущности (Users, Games, Genres, Developers).

Модель соответствует 2NF.

В MongoDB аналогичные отношения также сохраняются при вынесении связующих сущностей в отдельные коллекции (Wishlist, Friendships).

**Третья нормальная форма (3NF)**

Третья нормальная форма запрещает транзитивные зависимости неключевых атрибутов.

В исходной реляционной модели:

- Имя разработчика и жанра хранились в отдельных таблицах, исключая транзитивную зависимость от игры.
- Атрибуты пользователей находились только в сущности Users.
- Отзывы хранились отдельно и не содержали дублирующих данных о пользователе или игре.

Соответствие 3NF выполнено полностью.

В документно-ориентированной модели MongoDB некоторые данные (developer.name, genre.name) намеренно денормализованы для ускорения операций чтения.\
Это контролируемое отклонение от строгой нормализации, применённое осознанно в рамках гибридной модели.

**Соответствие нормальным формам в MongoDB**

Хотя NoSQL-модели не требуют строгой нормализации, логическая структура данных в проекте сохраняет принципы:

Нормализованная часть (хранится раздельно):

- Users
- Games (кроме денормализованных полей developer.name и genre.name)
- Reviews
- Transactions
- Developers
- Genres

Денормализованные элементы (хранятся внутри документов):

- reviews\_sample в Games — для ускорения вывода отзывов;
- friends, wishlist в Users — для минимизации числа запросов;
- metadata в Games — технические свойства игры, не требующие нормализации.

Такой подход соответствует гибридной модели хранения, сочетающей принципы нормализации и денормализации.

**Обоснование гибридного подхода**

Гибридная модель выбрана по следующим причинам:

1. Ускорение работы чтения\
   Часто запрашиваемая информация (примеры отзывов, разработчик, жанр) должна быть доступна без дополнительных JOIN или $lookup.
1. Снижение нагрузки на СУБД\
   Отдельные таблицы PostgreSQL были бы связаны через многочисленные связи N:1 и 1:N.\
   В MongoDB вложенные документы уменьшают количество операций.
1. Гибкость изменения структуры данных\
   Массивы и вложенные структуры позволяют редактировать данные без изменения общей схемы.
1. Сохранение целостности\
   Логическая нормализация на уровне сущностей исключает противоречивые данные, несмотря на отсутствие foreign keys.

Таким образом, итоговая модель Steam в MongoDB сочетает преимущества нормализованной реляционной схемы и производительность NoSQL-денормализации.



`				`**3. СОЗДАНИЕ ТАБЛИЦ**

`	`В отличие от реляционных СУБД, MongoDB не требует явного создания таблиц перед добавлением данных. Однако в рамках проектирования системы рекомендуется использовать валидацию схемы для обеспечения корректности структуры документов. Ниже приведены команды создания коллекций базы данных Steam с использованием механизма validator и JSON Schema.

db.createCollection("users", {

`  `validator: {

`    `$jsonSchema: {

`      `bsonType: "object",

`      `required: ["username", "email", "password\_hash", "registration\_date"],

`      `properties: {

`        `username: { bsonType: "string", minLength: 3, maxLength: 50 },

`        `email: { bsonType: "string", pattern: "^.+@.+\\..+$" },

`        `password\_hash: { bsonType: "string" },

`        `registration\_date: { bsonType: "date" },

`        `profile: {

`          `bsonType: "object",

`          `properties: {

`            `display\_name: { bsonType: "string" },

`            `country: { bsonType: "string", minLength: 2, maxLength: 2 }

`          `}

`        `},

`        `wishlist: {

`          `bsonType: "array",

`          `items: {

`            `bsonType: "object",

`            `required: ["game\_id"],

`            `properties: {

`              `game\_id: { bsonType: "objectId" },

`              `added\_date: { bsonType: "date" }

`            `}

`          `}

`        `},

`        `friends: {

`          `bsonType: "array",

`          `items: {

`            `bsonType: "object",

`            `required: ["user\_id"],

`            `properties: {

`              `user\_id: { bsonType: "objectId" },

`              `since: { bsonType: "date" }

`            `}

`          `}

`        `}

`      `}

`    `}

`  `}

});

db.users.createIndex({ email: 1 }, { unique: true });

db.users.createIndex({ username: 1 }, { unique: true });

db.users.createIndex({ "wishlist.game\_id": 1 });

db.createCollection("games", {

`  `validator: {

`    `$jsonSchema: {

`      `bsonType: "object",

`      `required: ["title", "price"],

`      `properties: {

`        `title: { bsonType: "string", minLength: 1, maxLength: 200 },

`        `release\_date: { bsonType: "date" },

`        `price: { bsonType: "number", minimum: 0 },

`        `developer: {

`          `bsonType: "object",

`          `required: ["id", "name"],

`          `properties: {

`            `id: { bsonType: "objectId" },

`            `name: { bsonType: "string" }

`          `}

`        `},

`        `genre: {

`          `bsonType: "object",

`          `required: ["id", "name"],

`          `properties: {

`            `id: { bsonType: "objectId" },

`            `name: { bsonType: "string" }

`          `}

`        `},

`        `average\_rating: { bsonType: "number", minimum: 1, maximum: 5 },

`        `reviews\_sample: {

`          `bsonType: "array",

`          `maxItems: 10,

`          `items: {

`            `bsonType: "object",

`            `properties: {

`              `user\_id: { bsonType: "objectId" },

`              `rating: { bsonType: "number", minimum: 1, maximum: 5 },

`              `comment: { bsonType: "string", maxLength: 500 },

`              `date: { bsonType: "date" }

`            `}

`          `}

`        `},

`        `metadata: {

`          `bsonType: "object",

`          `properties: {

`            `platforms: { bsonType: "array" },

`            `tags: { bsonType: "array" }

`          `}

`        `}

`      `}

`    `}

`  `}

});

db.games.createIndex({ title: "text" });

db.games.createIndex({ "genre.name": 1 });

db.games.createIndex({ "developer.name": 1 });

db.createCollection("developers", {

`  `validator: {

`    `$jsonSchema: {

`      `bsonType: "object",

`      `required: ["name"],

`      `properties: {

`        `name: { bsonType: "string", maxLength: 100 },

`        `website: { bsonType: "string" },

`        `country: { bsonType: "string" }

`      `}

`    `}

`  `}

});

db.developers.createIndex({ name: 1 }, { unique: true });

db.createCollection("genres", {

`  `validator: {

`    `$jsonSchema: {

`      `bsonType: "object",

`      `required: ["name"],

`      `properties: {

`        `name: { bsonType: "string", maxLength: 50 }

`      `}

`    `}

`  `}

});

db.genres.createIndex({ name: 1 }, { unique: true });

db.createCollection("reviews", {

`  `validator: {

`    `$jsonSchema: {

`      `bsonType: "object",

`      `required: ["game\_id", "user\_id", "rating", "review\_date"],

`      `properties: {

`        `game\_id: { bsonType: "objectId" },

`        `user\_id: { bsonType: "objectId" },

`        `rating: { bsonType: "number", minimum: 1, maximum: 5 },

`        `comment: { bsonType: "string", maxLength: 2000 },

`        `review\_date: { bsonType: "date" }

`      `}

`    `}

`  `}

});

db.reviews.createIndex({ game\_id: 1 });

db.reviews.createIndex({ user\_id: 1 });

db.reviews.createIndex(

`  `{ user\_id: 1, game\_id: 1 },

`  `{ unique: true }

);

db.createCollection("transactions", {

`  `validator: {

`    `$jsonSchema: {

`      `bsonType: "object",

`      `required: ["user\_id", "game\_id", "price", "purchase\_date"],

`      `properties: {

`        `user\_id: { bsonType: "objectId" },

`        `game\_id: { bsonType: "objectId" },

`        `price: { bsonType: "number", minimum: 0 },

`        `purchase\_date: { bsonType: "date" },

`        `payment\_method: { bsonType: "string" }

`      `}

`    `}

`  `}

});

db.transactions.createIndex({ user\_id: 1, purchase\_date: -1 });

db.transactions.createIndex({ game\_id: 1 });

db.createCollection("wishlist", {

`  `validator: {

`    `$jsonSchema: {

`      `bsonType: "object",

`      `required: ["user\_id", "game\_id"],

`      `properties: {

`        `user\_id: { bsonType: "objectId" },

`        `game\_id: { bsonType: "objectId" },

`        `added\_date: { bsonType: "date" }

`      `}

`    `}

`  `}

});

db.wishlist.createIndex({ user\_id: 1, game\_id: 1 }, { unique: true });

db.createCollection("friendships", {

`  `validator: {

`    `$jsonSchema: {

`      `bsonType: "object",

`      `required: ["user1\_id", "user2\_id"],

`      `properties: {

`        `user1\_id: { bsonType: "objectId" },

`        `user2\_id: { bsonType: "objectId" },

`        `friendship\_date: { bsonType: "date" }

`      `}

`    `}

`  `}

});

db.friendships.createIndex(

`  `{ user1\_id: 1, user2\_id: 1 },

`  `{ unique: true }

);



`					`**4. ЗАПРОСЫ**

`	`Для обеспечения корректного взаимодействия с базой данных MongoDB были разработаны наборы запросов, позволяющие выполнять операции выборки, добавления, обновления и удаления данных. 

**Добавление данных (INSERT)**

**1. Добавление нового пользователя**

db.users.insertOne({

`  `username: "gamer123",

`  `email: "gamer@example.com",

`  `password\_hash: "<bcrypt>",

`  `registration\_date: new Date(),

`  `profile: { display\_name: "Gamer", country: "RU" }

});

**2. Добавление игры**

db.games.insertOne({

`  `title: "The Witcher 3",

`  `price: 29.99,

`  `release\_date: new Date("2015-05-19"),

`  `developer: { id: ObjectId("..."), name: "CD Projekt Red" },

`  `genre: { id: ObjectId("..."), name: "RPG" },

`  `metadata: { platforms: ["PC"], tags: ["open-world", "story-rich"] }

});

**3. Добавление отзыва**

db.reviews.insertOne({

`  `game\_id: ObjectId("..."),

`  `user\_id: ObjectId("..."),

`  `rating: 5,

`  `comment: "Отличная игра!",

`  `review\_date: new Date()

});

**4. Добавление игры в wishlist**

db.users.updateOne(

`  `{ \_id: ObjectId("...") },

`  `{ $push: { wishlist: { game\_id: ObjectId("..."), added\_date: new Date() } } }

);

**Получение данных (SELECT)**

**1. Вывести всех пользователей**

db.users.find({});

**2. Найти игру по названию**

db.games.find({ title: /witcher/i });

**3. Получить все отзывы для конкретной игры**

db.reviews.find({ game\_id: ObjectId("...") });

**4. Список игр определённого жанра**

db.games.find({ "genre.name": "RPG" });

**5. История покупок пользователя**

db.transactions.find({ user\_id: ObjectId("...") }).sort({ purchase\_date: -1 });


**Обновление данных (UPDATE)**

**1. Обновить цену игры**

db.games.updateOne(

`  `{ \_id: ObjectId("...") },

`  `{ $set: { price: 19.99 } }

);

**2. Добавить отзыв в выборку reviews\_sample**

db.games.updateOne(

`  `{ \_id: ObjectId("game\_id") },

`  `{

`    `$push: {

`      `reviews\_sample: {

`        `$each: [

`          `{

`            `user\_id: ObjectId("user\_id"),

`            `rating: 5,

`            `comment: "Отличная игра!",

`            `date: new Date()

`          `}

`        `],

`        `$slice: -5

`      `}

`    `}

`  `}

);

**3. Обновить профиль пользователя**

db.users.updateOne(

`  `{ \_id: ObjectId("...") },

`  `{ $set: { "profile.display\_name": "ProGamer" } }

);

**Удаление данных (DELETE)**

**1. Удалить пользователя**

db.users.deleteOne({ \_id: ObjectId("...") });

**2. Удалить отзыв**

db.reviews.deleteOne({ \_id: ObjectId("...") });

**3. Очистить wishlist пользователя**

db.users.updateOne(

`  `{ \_id: ObjectId("...") },

`  `{ $set: { wishlist: [] } }

);

**Агрегационные запросы (ANALYTICS)**

**1. Получить средний рейтинг игры**

db.reviews.aggregate([

`  `{ $match: { game\_id: ObjectId("...") } },

`  `{ $group: { \_id: null, avgRating: { $avg: "$rating" } } }

]);

**2. Топ-5 игр по средней оценке**

db.reviews.aggregate([

`  `{ $group: { \_id: "$game\_id", avgRating: { $avg: "$rating" } } },

`  `{ $sort: { avgRating: -1 } },

`  `{ $limit: 5 }

]);

**3. Количество покупок каждой игры**

db.transactions.aggregate([

`  `{ $group: { \_id: "$game\_id", count: { $sum: 1 } } },

`  `{ $sort: { count: -1 } }

]);

**4. Количество игр каждого жанра**

db.games.aggregate([

`  `{ $group: { \_id: "$genre.name", total: { $sum: 1 } } },

`  `{ $sort: { total: -1 } }

]);

**5. Все игры + их средний рейтинг (через $lookup)**

db.games.aggregate([

`  `{

`    `$lookup: {

`      `from: "reviews",

`      `localField: "\_id",

`      `foreignField: "game\_id",

`      `as: "game\_reviews"

`    `}

`  `},

`  `{

`    `$addFields: {

`      `average\_rating: { $avg: "$game\_reviews.rating" }

`    `}

`  `},

`  `{

`    `$project: {

`      `title: 1,

`      `genre: "$genre.name",

`      `developer: "$developer.name",

`      `average\_rating: 1

`    `}

`  `}

]);

**Сложные запросы (использующие вложенность)**

**1. Найти пользователей, у которых в wishlist есть конкретная игра**

db.users.find({ "wishlist.game\_id": ObjectId("...") });

**2. Найти друзей пользователя (встроенная структура)**

db.users.find(

`  `{ \_id: ObjectId("...") },

`  `{ friends: 1 }

);

**3. Найти игры, доступные на платформе «PC»**

db.games.find({ "metadata.platforms": "PC" });

` `**Пример транзакции MongoDB**

(аналог ACID-транзакции PostgreSQL)

**Добавление отзыва + обновление среднего рейтинга игры:**

session = db.getMongo().startSession();

session.startTransaction();

try {

`  `const reviews = session.getDatabase("steam").reviews;

`  `const games = session.getDatabase("steam").games;

`  `reviews.insertOne(

`    `{

`      `game\_id: ObjectId("id1"),

`      `user\_id: ObjectId("id2"),

`      `rating: 4,

`      `comment: "Хорошая игра",

`      `review\_date: new Date()

`    `},

`    `{ session }

`  `);

`  `const agg = reviews.aggregate(

`    `[

`      `{ $match: { game\_id: ObjectId("id1") } },

`      `{ $group: { \_id: null, avg: { $avg: "$rating" } } }

`    `],

`    `{ session }

`  `).toArray();

`  `games.updateOne(

`    `{ \_id: ObjectId("id1") },

`    `{ $set: { average\_rating: agg[0].avg } },

`    `{ session }

`  `);

`  `session.commitTransaction();

} catch (e) {

`  `session.abortTransaction();

}



**5. Технологии доступа к БД**

Для взаимодействия с разработанной базой данных Steam, реализованной на основе MongoDB, используются различные технологии и инструменты, обеспечивающие доступ к данным из клиентского приложения, административные возможности и поддержку программной интеграции. Технологии доступа включают как стандартные средства MongoDB, так и прикладные библиотеки, предназначенные для разработки веб-приложений и серверных систем.

` `**MongoDB Shell (mongosh)**

**MongoDB Shell** — интерактивная консоль, позволяющая выполнять команды управления базой данных и запросы, написанные на JavaScript-like синтаксисе.

Основные возможности:

- добавление, обновление и удаление документов;
- выполнение агрегирующих запросов;
- создание и модификация коллекций;
- управление индексами;
- администрирование сервера и базы данных.

Используется для:

- первоначального наполнения БД,
- отладки запросов,
- диагностики производительности,
- администрирования.

**MongoDB Compass**

**MongoDB Compass** — графический интерфейс для работы с MongoDB.

Функциональные особенности:

- визуальное отображение документов и коллекций;
- построение запросов через интерфейс,
- создание индексов;
- просмотр агрегирующих операций в виде графа;
- диагностика данных и структуры.

Compass используется для:

- визуального анализа данных,
- тестирования структуры документов,
- мониторинга работы базы данных без необходимости писать код.

**Драйверы MongoDB для языков программирования**

MongoDB предоставляет официальные драйверы для большинства популярных языков, среди которых:

- **Node.js (MongoDB Node Driver)**
- **Python (PyMongo)**
- **Java**
- **C# (.NET)**
- **C++**
- **PHP**
- **Go**
- **Rust**

Эти драйверы позволяют приложению взаимодействовать с MongoDB напрямую, выполняя CRUD-операции, транзакции и агрегирующие запросы.

**Mongoose (ODM для Node.js)**

При разработке веб-приложений на JavaScript/TypeScript широко применяется библиотека **Mongoose**, являющаяся *Object Document Mapper* для MongoDB.

Преимущества Mongoose:

- декларативное описание схем коллекций,
- автоматическая валидация данных,
- удобный объектный интерфейс,
- middleware для обработки запросов,
- поддержка транзакций.

Пример подключения:

const mongoose = require("mongoose");

mongoose.connect("mongodb://localhost:27017/steam", { useNewUrlParser: true });

Mongoose рекомендуется для создания серверного приложения на Node.js.

**8.5. PyMongo (драйвер для Python)**

Для систем аналитики, скриптов обработки данных, автоматизации и ML-задач используется библиотека **PyMongo**, предоставляющая низкоуровневый интерфейс к MongoDB.

Пример подключения:

from pymongo import MongoClient

client = MongoClient("mongodb://localhost:27017/")

db = client.steam

PyMongo особенно удобен для работы с агрегирующим конвейером и пакетной обработкой данных.

**MongoDB Atlas**

**MongoDB Atlas** — облачная платформа для развертывания и управления MongoDB в облаке.

Преимущества:

- автоматическое масштабирование,
- резервное копирование,
- инструмент мониторинга,
- поддержка глобальной репликации,
- безопасный доступ через ключи и сертификаты.

Atlas обеспечивает доступ по безопасным URI:

mongodb+srv://user:password@cluster.mongodb.net/steam

Используется при развертывании проекта на продакшене.

**REST API и доступ к базе через серверное приложение**

Типичная архитектура веб-приложения Steam использует серверный слой между клиентом и базой данных.\
Доступ к MongoDB осуществляется не напрямую, а через REST API или GraphQL API.

Пример схемы доступа:

Клиент → REST API / GraphQL → Сервер → MongoDB

Преимущества:

- безопасность (права доступа, аутентификация),
- централизованная логика,
- кэширование,
- контроль транзакций.

**Технологии контроля доступа и безопасности**

Для безопасной работы с БД применяются следующие механизмы MongoDB:

1. **Role-Based Access Control (RBAC)** — настройка ролей пользователей (read, readWrite, dbAdmin и др.).
1. **SCRAM-аутентификация** — безопасная проверка подлинности.
1. **TLS-шифрование** — защита передаваемых данных.
1. **IP Whitelist** — ограничение доступа для конкретных сетей.
1. **Журналы аудита** — отслеживание действий пользователей.

**Интеграция с приложением и драйверы высокого уровня**

Кроме официальных драйверов применяются высокоуровневые инструменты:

- **Prisma MongoDB** (TypeScript ORM),
- **Spring Data MongoDB** (Java),
- **Entity Framework MongoDB provider** (C#),
- **FastAPI + Motor** (Python, асинхронный драйвер).

Эти средства позволяют создавать высокоуровневые модели данных, автоматизировать CRUD-операции и упрощать разработку сложных приложений.


\*

**Заключение**

В ходе выполнения проекта была разработана и реализована гибридная база данных, основанная на технологии MongoDB, предназначенная для хранения и обработки данных платформы цифровой дистрибуции игр, аналогичной сервису Steam. В процессе работы была проведена детальная проработка предметной области, определены сущности и их взаимосвязи, выполнена нормализация данных, а также построена гибридная модель, объединяющая элементы реляционного подхода и документно-ориентированной структуры.

Разработанная модель учитывает особенности функционирования платформы цифровой дистрибуции, обеспечивая эффективное хранение информации о пользователях, играх, разработчиках, жанрах, транзакциях и пользовательских отзывах. Применение гибридной структуры позволило оптимизировать взаимодействие между данными: нормализованные элементы гарантируют целостность, а денормализованные записи, такие как выборка отзывов или список желаемого, повышают производительность наиболее востребованных операций чтения.

В рамках проекта были созданы коллекции базы данных с использованием JSON Schema, обеспечены необходимые ограничения и индексы, реализованы основные CRUD-операции, а также сложные агрегирующие запросы, позволяющие выполнять аналитическую обработку данных. Дополнительно были рассмотрены современные технологии доступа к MongoDB, включая драйверы для различных языков программирования, инструменты администрирования и облачные сервисы.

Полученная база данных обладает гибкостью, масштабируемостью и высокой производительностью, что делает её подходящей основой для построения реальной информационной системы, способной обрабатывать значительные объёмы данных и поддерживать расширенную функциональность. Итоги работы подтверждают, что документно-ориентированная модель MongoDB в сочетании с элементами реляционного подхода позволяет эффективно решать задачи, характерные для современных сервисов цифровой дистрибуции.

Проект может быть расширен за счёт реализации механизмов кэширования, шардирования, обработки больших данных, интеграции с микросервисной архитектурой и внедрения систем рекомендаций на основе пользовательской активности. Таким образом, выполненная работа представляет собой полноценную основу для дальнейшего развития и внедрения распределённых высоконагруженных приложений.





**Список использованных источников**

`	`1. MongoDB. Официальная документация MongoDB [Электронный ресурс]. — Режим доступа: <https://www.mongodb.com/docs/> (дата обращения: 20.11.2025).

`	`2. MongoDB Aggregation Framework. Документация [Электронный ресурс]. — Режим доступа:\
https://www.mongodb.com/docs/manual/aggregation/ (дата обращения: 22.11.2025).

\*	3. MongoDB Atlas. Руководство пользователя [Электронный ресурс]. — Режим доступа:\
https://www.mongodb.com/atlas (дата обращения: 25.11.2025).

`	`4. Элмасри Р., Наватэ Ш. Системы баз данных: фундаментальные принципы. — М.: Диалектика, 2020. — 864 с.



